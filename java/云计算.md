# 云计算服务工程师-相关知识

## 什么是云(服务)？

* 云服务是由**云服务提供商**（eg 华为云，腾讯云，亚马逊AWS，谷歌云）提供的**计算资源和服务**，包括存计算、存储、数据库、人工智能等。致力于为企业提供全栈、全场景的**云解决方案**。
  * 解决方案就是技术和服务组合。
* 用户可以直接按需使用这些资源，无需拥有物理硬件。
  * 优势：用户节约成本，降低初期投资和运维成本；还可以弹性扩展；高可用；快速部署；安全
  * 劣势：依赖网络；隐私问题（数据存储在云端）；长期成本；


## 什么是“云原生”技术

云原生（cloud-native），是一种**方法论**。**充分利用云计算、容器化和微服务架构等现代化技术来构建和运行应用程序**。强调应用的**灵活性、可扩展性、高可用性**。

> native can be translate to '原生', so bad.

核心特点：

* **微服务架构**：将应用拆分成小的独立的服务，每个服务执行特定功能，便于独立开发、部署和扩展。
* **容器化**：将**应用和依赖环境打包**成容器，然后可以**确保在任何云环境中都能一致运行**。
* **动态管理**：通过自动化工具（如Kubernetes）进行容器和服务的部署、管理和扩展。

## k8s/docker/普罗米修斯

* Docker：用于**构建、运行、传送**应用程序的轻量级平台。
* Kubernetes (K8s)：**自动化管理和编排容器**应用的开源平台。它帮助管理大规模的容器集群，确保高可用性和负载均衡。
* Prometheus：用于**监控和报警**的开源时间序列数据收集系统。

## 本地部署deepseek

windows:

1. download ollama
2. ollama list: 展示本地模型
3. download deepseek: https://ollama.com/library/deepseek-r1:1.5b

## Docker

### 什么是Docker

* Docker是一个应用 ==**打包、分发、部署**== 的工具
  * **打包**：软件运行需要的依赖、第三方库、软件打包为一个安装包
  * **分发**：把打包好的安装包上传到一个镜像仓库，他人可以方便获取安装
  * **部署**：拿到安装包就可以一个命令运行起来应用，自动模拟出一模一样的运行环境
* 可以理解为一个轻量的虚拟机，它只虚拟你软件需要的运行环境，多余的不要。而普通虚拟机(eg linux虚拟机 VM)则是一个庞大的系统，包含各种你不管你要不要的软件 

### Docker vs. Linux虚拟机

Docker轻快但隔离性弱，适合高效部署应用。VM稳重但资源重，适合需要完整系统隔离的场景。

1. 资源使用
   1. Docker基于容器技术，容器共享宿主os的内核，只打包应用和依赖，资源占用小，启动速度快（秒级）
   2. Linux VM通过虚拟化技术运行完整的os，每个VM有独立的os内核，资源占用大(内存)，启动慢（分钟级）
2. 隔离性
   1. docker容器之间共享内核，若内核有安全漏洞，可能影响所有容器
   2. Linux VM隔离型强，每个VM，互不干扰
3. 可移植性
   1. docker容器可以轻松打包并跨环境迁移（只要宿主系统兼容即可）
   2. Linux VM整个os难以迁移

### 基础

**镜像**(Image)：软件安装包，包含环境依赖
**容器**(Container)：软件安装后的状态，**容器是镜像的运行实例**。当你从一个镜像启动容器时，docker会在镜像的基础上创建一个容器，并将容器的文件系统、网络、环境变量等与宿主机隔离开来。不同容器之间隔离。

---

Docker安装镜像

* 安装最新版redis`docker run -d -p 6379:6379 --name redis redis:latest`
  * -d 后台
  * `-p 宿主机端口 : 容器内端口`: 将容器的6379**端口暴露**到宿主机的6379端口(容器是隔离环境，有自己的ip+port，不映射的话就访问不到应该)
  * --name 容器命名
  * `-v 数据卷名:容器内目录`：挂载目录，把宿主机目录(绝对路径)挂载到容器内目录
    * eg `-v D:/code/testcode_dir:/app`

---

制作自己的镜像

* `docker build -t name:version`
  * -t 设置镜像名称和版本号
  * 需要提前写好dockerfile

做好之后，别人就可以docker run了

---

Docker挂载目录

为何要挂载目录？

1. **数据持久化**：容器本身是临时的，停止或删除后内部数据都丢失了，而我们想持久化一些数据，eg 数据库数据文件、日志文件等，这时候我们就会挂载到宿主机的目录中
2. **共享文件/配置**：多个容器可以共享配置文件or资源

* `bind mount`: 直接把宿主机目录映射到容器内
* `volumn`: 由容器创建和管理，创建在宿主机，所以删除容器不会丢失，官方推荐

---

Docker多容器通信

